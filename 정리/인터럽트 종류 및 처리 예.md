## 인터럽트란 - 인터럽트 종류 및 처리 예

**인터럽트 처리 예**

- CPU가 프로그램을 실행하고 있을 때,
  - **입출력 하드웨어 등의 장치 이슈 발생**
    1. **파일 처리가 끝났다**는 것을 운영체제에 알려준다.
    2. 운영체제는 해당 프로세스를 block state에서 실행대기(ready) 상태로 프로세스 상태를 변경한다.
  - 또는 **예외 상황이 발생**
    1. 0으로 나누는 계산이 발생해서, 예외 발생을 운영체제에 알려준다.
    2. 운영체제가 해당 프로세스 실행 중지/에러를 표시한다.



**이벤트와 인터럽트**

- 인터럽트는 일종의 **이벤트**로도 불린다.
- 그로 인해 **이벤트에 맞게 운영체제가 처리**한다.



**주요 인터럽트**

1. 계산하는 코드에서 0으로 나누는 코드 실행 시..

   ~~~java
   public static int divideByZero() {
     System.out.println("hello");
     int data;
     int divider = 0;
     data = 1 / divider;	//해당 부분에서 인터럽트가 발생
     return 0;
   }
   ~~~

   - 해당 소스는 컴파일 시점에서는 에러 부분을 체크하지 않고, CPU에 해당 소스를 실행시킬 때 에러 부분을 체크할 수 있다.
   - 즉, 1/0의 연산을 진행하고자 할 때 예외 발생을 CPU에게 알려주고 CPU는 해당 부분을 중지하고 에러까지 노출시키는 것이다.

   <img src="https://user-images.githubusercontent.com/40616436/80678652-515f2800-8af6-11ea-9a1f-ac9010868374.png" alt="image" style="zoom:50%;" />

   - 해당 메시지가 인터럽트 처리 루틴으로 볼 수 있는 것이다.

2. 타이머 인터럽트

   - 선점형 스케줄러를 위해 필요한 것이다.

   <img src="https://user-images.githubusercontent.com/40616436/80679255-7b651a00-8af7-11ea-85ae-432fd7c1ebda.png" alt="image" style="zoom:50%;" />

   - 100ms일 때 프로세스를 변경해야 할 때 타이머 인터럽트 방식을 활용하여 10ms마다 운영체제에게 인터럽트를 걸어 100ms가 되는 순간 스케줄러가 깨어 프로세스가 변경되게 되는 것이다.

3. 입출력(IO) 인터럽트

   - 프린터, 키보드, 마우스, 저장매체(SSD) 등이 있다.
   - 외부에서 발생한 이벤트를 처리하기 위해서 인터럽트가 발생하는 것이다.



**인터럽트의 종류**

- 내부 인터럽트
  - **주로 프로그램 내부에서 잘못된 명령(예외 상황) 또는 잘못된 데이터 사용을 할 때 발생한다.**
    - 0으로 나눴을 때
    - 사용자 모드에서 허용되지 않는 명령 또는 공간에 접근 할 때
      - C언어 포인터는 주소를 가리키는데, 주소를 잘못 가리킬 시 프로세스가 다운되는 현상이 나타난다.
      - 하나의 프로세스는 총 4GB(사용자 모드 : 3GB, 커널 모드 : 1GB)인데, 사용자 모드에서 커널 모드로 접근을 할 때 인터럽트로 처리를 진행하게 된다.
    - 계산 결과가 Overflow/Underflow날 때
      - 해당 변수를 표현할 수 있는 범위를 벗어날 경우가 Overflow/Underflow가 발생한다.
- 외부 인터럽트
  - 주로 하드웨어에서 발생되는 이벤트(프로그램 외부)
    - 전원 이상
    - 기계 문제
    - 키보드 등 IO 관련 이벤트
    - Timer 이벤트
- 내부 인터럽트는 주로 프로그램 내부에서 발생하므로, **소프트웨어 인터럽트**라고도 한다.
- 외부 인터럽트는 주로 하드웨어에서 발생하므로, **하드웨어 인터럽트**라고도 한다.



